{"version":3,"file":"lazy-load-imgs.umd.js","sources":["../../src/scripts/constants.ts","../../src/scripts/lazy-observer-options.ts","../../src/scripts/types.d.ts","../../src/scripts/utils.ts","../../src/scripts/lazy.class.ts","../../src/components/lazy-load-imgs.vue","../../src/components/lazy-load-imgs.vue","../../index.ts"],"sourcesContent":["// 默认加载中显示的图片\r\nexport const DEFAULT_LOADING_IMG =\r\n  'data:image/jpeg;base64,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';\r\n\r\n// 默认加载失败显示的图片\r\nexport const DEFAULT_ERROR_IMG =\r\n  'data:image/jpeg;base64,/9j/4QAYRXhpZgAASUkqAAgAAAAAAAAAAAAAAP/sABFEdWNreQABAAQAAAA8AAD/4QMraHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLwA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/PiA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJBZG9iZSBYTVAgQ29yZSA1LjMtYzAxMSA2Ni4xNDU2NjEsIDIwMTIvMDIvMDYtMTQ6NTY6MjcgICAgICAgICI+IDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+IDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOkVFRENBRUZFRUQ0QzExRUY5MDUwRTE1RDhDQThCRUVCIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOkVFRENBRUZERUQ0QzExRUY5MDUwRTE1RDhDQThCRUVCIiB4bXA6Q3JlYXRvclRvb2w9IkFkb2JlIFBob3Rvc2hvcCBDUzYgKFdpbmRvd3MpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6RUM1NDczNTJFRDQ2MTFFRjk3NUY4MDM3RkM3RjE5OEMiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6RUM1NDczNTNFRDQ2MTFFRjk3NUY4MDM3RkM3RjE5OEMiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz7/7gAOQWRvYmUAZMAAAAAB/9sAhAAGBAQEBQQGBQUGCQYFBgkLCAYG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';\r\n\r\n// 检测的图片扩展名列表（如果不符合，控制台打印警告）\r\nexport const IMG_EXTNAME_LIST = '(jpg|jpeg|gif|png|pneg|bmp|svg|webp)';\r\n","/**\r\n * LazyLoadImgs.vue 组件的 Props 参数 lazyOptions 和 observerOptions 的配置项默认值\r\n */\r\n\r\n// 导入常量\r\nimport { DEFAULT_ERROR_IMG, DEFAULT_LOADING_IMG } from '@/scripts/constants';\r\n\r\n// 导入 TS 类型声明\r\nimport { ELifecycle, ILazyOptions } from '@/scripts/types';\r\n\r\n// 懒加载选项参数配置\r\nexport const lazyOptionsObj: ILazyOptions = {\r\n  // 图片加载中状态显示的图片\r\n  loadingImg: DEFAULT_LOADING_IMG,\r\n  // 图片加载失败状态显示的图片\r\n  errorImg: DEFAULT_ERROR_IMG,\r\n  // 图片各加载状态生命周期回调函数（默认不执行图片加载状态回调函数，需要的话，指定即可）\r\n  /* lifeFunc: {\r\n        // 图片加载中的回调函数\r\n        [ELifecycle.LOADING]: (imgEl: HTMLImageElement) => { console.log('Loading image: ', imgEl) },\r\n        // 图片加载成功后的回调函数\r\n        [ELifecycle.LOADED]: (imgEl: HTMLImageElement) => { console.log('Loaded image: ', imgEl) },\r\n        // 图片加载失败后的回调函数\r\n        [ELifecycle.ERROR]: (imgEl: HTMLImageElement) => { console.log('Loaded image error: ', imgEl) }\r\n    }, */\r\n  // 图片进入视口交叉状态后，延迟多久加载图片（ms）\r\n  delay: 500,\r\n};\r\n\r\n// observer 选项参数配置\r\nexport const observerOptionsObj: IntersectionObserverInit = {\r\n  // 图片进入可视交叉状态的根容器，默认为浏览器视口(null)，建议取默认值 null 即可\r\n  root: null,\r\n  // 根容器 margin 值，建议取默认值 0px 即可\r\n  rootMargin: '0px',\r\n  // 图片进入与根容器交叠重叠范围的百分比(0-1之间)，即进入可视范围多少百分比后，进行加载，建议取默认值为 0 即可\r\n  threshold: 0,\r\n};\r\n","// 由 Props 传入的创建 lazy 实例对象的构造函数参数类型定义\r\nexport interface ILazyOptions {\r\n  // 图片加载中状态显示的图片\r\n  loadingImg?: string;\r\n  // 图片加载失败状态显示的图片\r\n  errorImg?: string;\r\n  // Lazy 实例对象生命周期回调函数\r\n  lifeFunc?: TLifeFunc;\r\n  // 图片进入视口交叉状态后，延迟多久加载图片（ms）\r\n  delay?: number;\r\n}\r\n\r\n// 图片加载状态的枚举类型定义\r\nexport enum ELifecycle {\r\n  LOADING = 'loading',\r\n  LOADED = 'loaded',\r\n  ERROR = 'error',\r\n}\r\n\r\n// 图片加载生命周期函数类型定义\r\nexport type TLifeFunc = {\r\n  [K in ELifecycle]?: (imgEl: HTMLImageElement, ...args: any[]) => any;\r\n};\r\n\r\n// img 标签的 data-img-id 自定义属性枚举常量\r\nexport enum EImgCustAttr {\r\n  IMG_ID = 'data-img-id',\r\n  ORIG_SRC = 'data-orig-src',\r\n  TIMEOUT_ID = 'data-timeout-id',\r\n  LOAD_STATUS = 'data-load-status',\r\n}\r\n\r\n// Vue3/Vue2 更新 v-model/modelValue 参数的 emit('update:modelValue) 或者 emit('chgImgList') 泛型函数事件参数类型\r\nexport type EmitFunc = (event: 'update:modelValue', ...args: any[]) => void;\r\n","import { DEFAULT_LOADING_IMG } from './constants';\r\nimport { EImgCustAttr } from './types';\r\n\r\n/**\r\n * @description - 检查浏览器是否存在支持 IntersectionObserver 的必要属性\r\n * @returns\r\n */\r\nexport function hasIntersectionObserver(): boolean {\r\n  if (\r\n    window &&\r\n    'IntersectionObserver' in window &&\r\n    'IntersectionObserverEntry' in window &&\r\n    'intersectionRatio' in window.IntersectionObserverEntry.prototype\r\n  ) {\r\n    // 微软 Edge 15 浏览器不支持 isIntersecting 属性，\r\n    // 详见：// See: https://github.com/w3c/IntersectionObserver/issues/211\r\n    if (!('isIntersecting' in window.IntersectionObserverEntry.prototype)) {\r\n      // Object.defineProperty 同一属性不能重定义多次，重复定义会报错，\r\n      // Reflect.defineProperty 同一属性可重复定义多次，首次定义返回 true，多次定义返回 false\r\n      Reflect.defineProperty(window.IntersectionObserverEntry.prototype, 'isIntersecting', {\r\n        get() {\r\n          return this.intersectionRatio > 0;\r\n        },\r\n      });\r\n    }\r\n\r\n    return true;\r\n  }\r\n\r\n  return false;\r\n}\r\n\r\n/**\r\n * @description - 检查值是否为纯对象类型\r\n * @param value\r\n * @returns\r\n */\r\nexport function isObject(value: any): value is object {\r\n  return toString.call(value) === '[object Object]';\r\n}\r\n\r\n/**\r\n * @description - 检查值是否为数组类型\r\n * @param value\r\n * @returns\r\n */\r\nexport function isArray(value: any): value is Array<any> {\r\n  return toString.call(value) === '[object Array]' || Array.isArray(value);\r\n}\r\n\r\n/**\r\n * @description - 检查值是否为函数类型\r\n * @param value\r\n * @returns\r\n */\r\nexport function isFunc(value: any): value is Function {\r\n  return toString.call(value) === '[object Function]' || typeof value === 'function';\r\n}\r\n\r\n/**\r\n * @description - 检查值是否为日期类型\r\n * @param value\r\n * @returns\r\n */\r\nexport function isDate(value: any): value is Date {\r\n  return toString.call(value) === '[object Date]' || value instanceof Date;\r\n}\r\n\r\n/**\r\n * @description - 检查值是否为正则表达式类型\r\n * @param value\r\n * @returns\r\n */\r\nexport function isRegExp(value: any): value is RegExp {\r\n  return toString.call(value) === '[object RegExp]' || value instanceof RegExp;\r\n}\r\n\r\n/**\r\n * @description - 检查值是否为错误对象类型\r\n * @param value\r\n * @returns\r\n */\r\nexport function isError(value: any): value is Error {\r\n  return toString.call(value) === '[object Error]' || value instanceof Error;\r\n}\r\n\r\n/**\r\n * @description - 支持深度递归拷贝 8 种类型的对象\r\n * @param obj\r\n * @returns\r\n */\r\nexport function deepCopy(\r\n  obj: any,\r\n  // 要深拷贝对象的类型，默认深拷贝如下 8 种类型的对象（不包括 WeakSet 和 WeakMap）\r\n  which: ('object' | 'array' | 'function' | 'date' | 'regexp' | 'error' | 'set' | 'map')[] = [\r\n    'object',\r\n    'array',\r\n    'function',\r\n    'date',\r\n    'regexp',\r\n    'error',\r\n    'set',\r\n    'map',\r\n  ]\r\n) {\r\n  // 如果是 null 或原始类型，直接返回\r\n  if (obj === null || (typeof obj !== 'object' && typeof obj !== 'function')) return obj;\r\n\r\n  if (isObject(obj) && which.includes('object')) {\r\n    // 如果值为纯对象\r\n    return Object.keys(obj).reduce((newObj, k, i) => {\r\n      newObj[k] = deepCopy(obj[k], which);\r\n      return newObj;\r\n    }, {});\r\n  } else if (isArray(obj) && which.includes('array')) {\r\n    // 否则如果值为数组\r\n    return obj.reduce((arr, v, i) => {\r\n      arr[i] = deepCopy(v, which);\r\n      return arr;\r\n    }, []);\r\n  } else if (isFunc(obj) && which.includes('function')) {\r\n    // 否则如果值为函数\r\n    // 创建一个全新的函数，而非函数引用\r\n    const newFunc = new Function('return ' + obj.toString())();\r\n    // 返回创建的新函数\r\n    return newFunc;\r\n  } else if (isDate(obj) && which.includes('date')) {\r\n    // 否则如果值为日期类型\r\n    return new Date(obj.getTime());\r\n  } else if (isRegExp(obj) && which.includes('regexp')) {\r\n    // 否则如果值为正则表达式类型\r\n    return new RegExp(obj.source, obj.flags);\r\n  } else if (isError(obj as Error) && which.includes('error')) {\r\n    // 否则如果值为错误对象类型\r\n    const errorProps = { ...obj };\r\n    // 删除不可枚举属性和不可复制属性\r\n    Object.getOwnPropertyNames(obj).forEach((k) => {\r\n      if (k === 'stack') {\r\n        errorProps[k] = obj[k].split('\\n');\r\n      }\r\n      // 只有可枚举的自有属性是可复制的\r\n      if (\r\n        obj.hasOwnProperty('k') &&\r\n        k !== 'message' &&\r\n        k !== 'name' &&\r\n        k !== 'stack' &&\r\n        k !== 'constructor'\r\n      ) {\r\n        errorProps[k] = obj[k];\r\n      }\r\n    });\r\n    // 创建新的Error实例并设置属性\r\n    const newError = new Error(obj.message);\r\n    newError.name = obj.name;\r\n    newError.stack = errorProps.stack.join('\\n') + ' '; // 至少加个空格，stack 才是复制，否则是引用\r\n    // 复制其他属性\r\n    Object.getOwnPropertyNames(errorProps).forEach((k) => {\r\n      if (!['message', 'name', 'stack'].includes(k)) {\r\n        Reflect.defineProperty(newError, k, Reflect.getOwnPropertyDescriptor(errorProps, k)!);\r\n      }\r\n    });\r\n    // 返回深拷贝的新错误对象\r\n    return newError;\r\n  } else if (obj instanceof Set && which.includes('set')) {\r\n    // 否则如果值为 Set 集合类型\r\n    // 循环遍历原 Set 集合的每个集合项，生成新的集合项：使用 Array.from，[...obj] 兼容性不够好\r\n    const newSetItems = Array.from(obj).reduce((arr: any[], v: any, i: number) => {\r\n      arr[i] = deepCopy(v, which);\r\n      return arr;\r\n    }, []);\r\n    // 根据以上生成的新集合项，重新创建新的 Set 集合对象并返回\r\n    const newSet = new Set([...newSetItems]);\r\n    return newSet;\r\n  } else if (obj instanceof Map && which.includes('map')) {\r\n    // 否则如果值为 Map 键值映射类型\r\n    // 将 Map 映射类型转换为 object 对象\r\n    const map2Obj = Object.fromEntries(obj);\r\n    // 深拷贝转换后的对象\r\n    const newMap2Obj = deepCopy(map2Obj, which);\r\n    // 根据深拷贝转换后的对象创建新的 Map 键值映射对象\r\n    const newMap = new Map(Object.entries(newMap2Obj));\r\n    // 返回新的 Map 键值映射对象\r\n    return newMap;\r\n  }\r\n\r\n  // 如果是其它类型的值，如 WeakSet, WeakMap 对象弱引用类型，则直接返回\r\n  return obj;\r\n}\r\n\r\n/**\r\n * @description - 根据图片 url 创建图片对象\r\n * @param imgUrl\r\n * @returns\r\n */\r\nexport function createImgObjFromUrl(imgUrl: string): Promise<{ img: HTMLImageElement; err: null | Event }> {\r\n  return new Promise((resolve, reject) => {\r\n    const img = new Image();\r\n    img.onload = (e) => resolve({ img, err: null });\r\n    img.onerror = (e) => {\r\n      console.log('Could not load loadingImg at ' + imgUrl);\r\n      reject({ img, err: e }); // 如果加载图片出错，img.width 和 img.height 均为0\r\n    };\r\n    img.src = imgUrl;\r\n  });\r\n}\r\n\r\n/**\r\n * @description - 等待加载预加载图片 loadingImg\r\n * @param imgUrl\r\n * @param instId\r\n * @returns\r\n */\r\nexport function waitLoadingImg(\r\n  imgUrl: string,\r\n  instId: number\r\n): Promise<{ img: HTMLImageElement; err: null | Event }> {\r\n  return new Promise((resolve, reject) => {\r\n    const img = new Image();\r\n\r\n    img.onload = (e) => resolve({ img, err: null });\r\n\r\n    img.onerror = (e) => {\r\n      // 如果加载用户通过 props 传入的 loadingImg 预加载图片失败，则更改为本组件内置的默认的 base64 格式的预加载图片\r\n      console.warn(`[lazy-load-imgs]: Could not load loadingImg at ${imgUrl}.\r\nNow using the default base64 encoding format for preloaded images(loadingImg).`);\r\n      img.src = DEFAULT_LOADING_IMG;\r\n\r\n      // 获取本懒加载组件实例的每个 img 元素（即使用本组件标签包裹起来的所有 img 标签集合）\r\n      const allImgs = document.querySelectorAll(`img[${EImgCustAttr.IMG_ID}^=inst${instId}-]`);\r\n      // console.log('allImgs:', allImgs, instId);\r\n      // 修改本懒加载组件实例内的所有图片的 src 属性显示为默认的 base64 格式的预加载图片\r\n      Array.prototype.forEach.call(allImgs, (img: HTMLImageElement) => {\r\n        img.setAttribute('src', DEFAULT_LOADING_IMG);\r\n      });\r\n\r\n      reject({ img, err: e }); // 如果加载图片出错，img.width 和 img.height 均为0\r\n    };\r\n\r\n    img.src = imgUrl;\r\n  });\r\n}\r\n\r\n/**\r\n * @description - 等待加载预加载图片 loadingImg（unused）\r\n * @param imgUrl\r\n * @param instId\r\n * @param attemps\r\n * @param timeout\r\n * @returns\r\n */\r\nexport function waitLoadingImg_unused(\r\n  imgUrl: string,\r\n  instId: number,\r\n  attemps = 1,\r\n  timeout = 100\r\n): Promise<{ img: HTMLImageElement; err: null | Event }> {\r\n  return new Promise((resolve, reject) => {\r\n    const img = new Image();\r\n    let isTimeout = false;\r\n    let attemps_num = 0;\r\n    img.onload = (e) => {\r\n      if (isTimeout && attemps_num < attemps) {\r\n        img.src = imgUrl;\r\n        attemps_num++;\r\n        console.log('onload attemps_num:', attemps_num);\r\n      } else {\r\n        setTimeout(() => {\r\n          console.log('onload success');\r\n          resolve({ img, err: null });\r\n        }, 2000);\r\n      }\r\n    };\r\n    img.onerror = (e) => {\r\n      if (attemps_num < attemps) {\r\n        img.src = imgUrl;\r\n        attemps_num++;\r\n        console.log('onerror attemps_num:', attemps_num);\r\n      } else {\r\n        img.src = DEFAULT_LOADING_IMG;\r\n        // 获取本组件每个实例需要开启监听的每个 img 元素（即使用本组件标签包裹起来的所有 img 标签集合）\r\n        const allImgs = document.querySelectorAll(`img[${EImgCustAttr.IMG_ID}^=inst${instId}-]`);\r\n        // console.log('allImgs:', allImgs, instId);\r\n        Array.prototype.forEach.call(allImgs, (img: HTMLImageElement) => {\r\n          img.src = DEFAULT_LOADING_IMG;\r\n        });\r\n        console.log('Could not load loadingImg at ' + imgUrl);\r\n        // reject({ img, err: e });  // 如果加载图片出错，img.width 和 img.height 均为0\r\n      }\r\n    };\r\n    img.src = imgUrl;\r\n    setTimeout(() => {\r\n      isTimeout = true;\r\n    }, timeout);\r\n  });\r\n}\r\n\r\n/**\r\n * @description - 文件转 base64\r\n * @param {string} url - 文件 url\r\n * @returns {Promise<string>}\r\n */\r\nexport async function url2base64(url: string, imgType = 'image/jpeg'): Promise<string> {\r\n  let base64 = '';\r\n  // url 转 blob\r\n  const blob = await window\r\n    .fetch(url, {\r\n      headers: {\r\n        'Content-Type': imgType,\r\n      },\r\n    })\r\n    .then((res) => res.blob());\r\n  // console.log('blob:', blob);\r\n\r\n  // 读取 blob 和转换\r\n  const reader = new FileReader();\r\n  reader.readAsArrayBuffer(blob);\r\n  reader.onload = (e) => {\r\n    // blob 转 buffer\r\n    const buffer = new Uint8Array(e.target!.result as ArrayBuffer);\r\n    // console.log('buffer:', buffer);\r\n\r\n    // buffer 转字节码\r\n    const byteCode = buffer.reduce((prevByte, byte) => {\r\n      prevByte += String.fromCharCode(byte);\r\n      return prevByte;\r\n    }, '');\r\n    // console.log('byteCode:', byteCode);\r\n\r\n    // 字节码转 base64\r\n    return (base64 = window.btoa(byteCode));\r\n    // console.log('base64:', base64);\r\n  };\r\n\r\n  return new Promise((resolve) => {\r\n    setTimeout(() => {\r\n      resolve(base64);\r\n    }, 10);\r\n  });\r\n}\r\n","import { isVue2, isVue3, VNode } from 'vue-demi';\r\nimport { lazyOptionsObj, observerOptionsObj } from './lazy-observer-options';\r\nimport { EImgCustAttr, ELifecycle, EmitFunc, ILazyOptions } from './types';\r\nimport { deepCopy } from './utils';\r\n\r\n/**\r\n * @description - 图片懒加载实现类\r\n */\r\nexport class Lazy {\r\n  /**\r\n   * @property {ILazyOptions} _lazyOptions - 默认懒加载配置选项\r\n   * @memberof Lazy\r\n   */\r\n  private _lazyOptions: ILazyOptions = deepCopy(lazyOptionsObj);\r\n\r\n  /**\r\n   * @property {IntersectionObserverInit} _observerOptions - IntersectionObserver 监听目标进入可视化实例的默认初始化参数\r\n   * @memberof Lazy\r\n   */\r\n  private _observerOptions: IntersectionObserverInit = deepCopy(observerOptionsObj);\r\n\r\n  // 由 Props 传入的自定义比如从后端获取的文章信息列表中每篇文章的 html 内容字段名，\r\n  // 使用 v-html 指令渲染 html 格式的文章内容时，必须传该参数\r\n  private _htmlFieldName: string | undefined;\r\n\r\n  // 创建用于实现懒加载图片监听器的 IntersectionObserver 类的实例对象\r\n  private _imgObserver: IntersectionObserver | null = null;\r\n\r\n  // 组件递增实例ID\r\n  static instId = 0;\r\n\r\n  // 本组件默认插槽内的 img 节点ID\r\n  private _imgId = 1;\r\n\r\n  // 保存 <img> 标签里 data-img-id 属性值的数组\r\n  private _dataImgIdList: string[] = [];\r\n\r\n  // 控制台日志提示内容前缀\r\n  private _logMsgPrefix = '[vue-lazyload-imgs]:';\r\n\r\n  // 如果使用了内置的 v-html 指令梆定的值是通过 html 字符串数组通过 v-for 进行渲染的，必须要调用 emits 反向\r\n  // 修改梆定值，否则无法实现懒加载效果；\r\n  // 记录每个 html 数组元素，最后再调用 emits('update:modelValue', modelHtmlArr) 反向修改梆定变量\r\n  private _modelHtmlIdx = 0;\r\n  private _modelHtmlArr: object[] = [];\r\n\r\n  /**\r\n   * @description - 构造函数\r\n   * @param lazyOptions\r\n   * @param observerOptions\r\n   * @memberof Lazy\r\n   */\r\n  constructor(\r\n    lazyOptions: ILazyOptions,\r\n    observerOptions: IntersectionObserverInit,\r\n    htmlFieldName: string | undefined\r\n  ) {\r\n    Lazy.instId++;\r\n    this._lazyOptions = Object.assign(this._lazyOptions, lazyOptions);\r\n    this._observerOptions = Object.assign(this._observerOptions, observerOptions);\r\n    this._htmlFieldName = htmlFieldName;\r\n  }\r\n\r\n  /**\r\n   * @description - 循环递归读取插槽中的 img 标签的 vnode，替换原来的 src 属性为 loadingImg，并将原图src设置到 data-orig-src 属性中\r\n   * @param vnodes - slot 中的 html 虚拟节点\r\n   * @param modelValue - 父组件传过来的双向梆定值，用于支持使用 v-html 指令梆定 html 字符串（或数组）变量进行渲染\r\n   * @param emits - defineEmits 宏接收的父组件传过来的双向梆定事件调用函数\r\n   * @memberof Lazy\r\n   * @returns\r\n   */\r\n  public setImgSrcToLoadingImg(\r\n    vnodes: VNode[],\r\n    modelValue: string | object[] | undefined,\r\n    emits: EmitFunc\r\n  ): string[] {\r\n    // 如果插槽有节点内容\r\n    if (Array.isArray(vnodes) && vnodes.length > 0) {\r\n      // 设置在每个 img 标签中自定义属性 data-img-id 中的唯一值 = 本组件实例递增ID值 + img 节点ID，如：inst1-1\r\n      let dataImgId = '';\r\n      // 支持如果 vnode 对应的标签使用了 v-html 内置指令进行渲染 html 内容，则使用正则表达式获取指令值内的所有 img 标签\r\n      const imgHtmlReg = new RegExp('<\\\\s*img\\\\s+src\\\\s*=\\\\s*.*(\\\\/)?\\\\s*>', 'gi');\r\n      // 【支持筛选 v-html 指令中的 img 标签内容】：如果 vnode 使用了 v-html 指令，则保存指令内所有 img 标签条目\r\n      let imgsInHtml: string[] | null = null;\r\n\r\n      // 开始循环遍历处理插槽的每个 vnode\r\n      vnodes.forEach((vnode: any) => {\r\n        // 如果插槽节点是单节点，没有子节点\r\n        if (!vnode.children && typeof vnode.children !== 'string') {\r\n          // 【重点】Vue2/3 需分别判断 vnode 的 attrs/props 属性\r\n          const vnodeProps = isVue2 ? vnode?.data?.attrs : vnode.props;\r\n          // 【重点】Vue2/3 需分别判断 vnode 的 innerHTML 属性，\r\n          // Vue2 为 vnode.data.domProps.innerHTML，Vue3 为 vnode.props.innerHTML\r\n          const vnodeInnerHTMLObj = isVue2 ? vnode?.data?.domProps : vnode.props;\r\n          // 【重点】Vue2/3 需分别判断 vnode 的标签类型是哪一种 html 标签\r\n          const vnodeTag = isVue2 ? vnode.tag : vnode.type;\r\n\r\n          // 如果插槽节点是 img 节点，一般如果是 img 标签，都会存在 vnode.props（Vue3）或 vnode.data.attrs（Vue2）属性，\r\n          // 所以这里只需要判断是 img 标签也可以\r\n          if (vnodeTag === 'img' && vnodeProps) {\r\n            // 在 img 节点上设置的自定义属性 data-img-id 的值\r\n            dataImgId = `inst${Lazy.instId}-${this._imgId++}`;\r\n            vnodeProps[EImgCustAttr.IMG_ID] = dataImgId;\r\n            // 记录添加的节点ID到列表\r\n            this._dataImgIdList.push(dataImgId);\r\n            // 设置原图到自定义 data-orig-src 属性中\r\n            vnodeProps[EImgCustAttr.ORIG_SRC] = vnodeProps.src;\r\n            // 设置图片src属性为加载中的图片\r\n            vnodeProps.src = this._lazyOptions.loadingImg;\r\n          } else if (\r\n            vnodeInnerHTMLObj?.innerHTML &&\r\n            (imgsInHtml = vnodeInnerHTMLObj?.innerHTML.match(imgHtmlReg))\r\n          ) {\r\n            // console.log('imgsInHtml:', imgsInHtml, 'vnode:', vnode);\r\n            // 如果 vnode 节点对应的 html 标签使用了 v-html 内置指令（vnode.props存在innerHTML属性），\r\n            // 则应筛选出指令值内使用到的所有 <img> 标签的内容，并更改该 vnode 的 props.src 属性值为 loadingImg\r\n            imgsInHtml.forEach((img: string) => {\r\n              // 在 img 节点上设置的自定义属性 data-img-id 的值\r\n              dataImgId = `inst${Lazy.instId}-${this._imgId++}`;\r\n              // 记录添加的节点ID到列表\r\n              this._dataImgIdList.push(dataImgId);\r\n              // 为 img html 标签字符串添加的 data-img-id 自定义属性\r\n              const dataIdAttr = `${EImgCustAttr.IMG_ID}=\"${dataImgId}\"`;\r\n              // 在 img html 标签字符串获取原 src 属性值\r\n              const srcVal = img.match(/\\s*src\\s*=\\s*['\"`]?(.*)['\"`].?/i)![1]; // .?杜绝贪婪匹配多次，只匹配一次\r\n              // 为 img html 标签字符串添加的 data-orig-src 自定义属性\r\n              const origSrcAttr = `${EImgCustAttr.ORIG_SRC}=\"${srcVal}\"`;\r\n              // 在 img 标签字符串添加以上两个自定义属性\r\n              let newImg = img.replace(/((\\/?)\\s*>)/, ` ${dataIdAttr} ${origSrcAttr} $1`);\r\n              // 将 img 标签字符串中的 src 属性值替换为 loadingImg\r\n              newImg = newImg.replace(srcVal, this._lazyOptions.loadingImg!);\r\n              // console.log('origImg:', img, 'newImg:', newImg);\r\n              // 替换使用了 v-html 指令的 vnode.props.innerHTML 里原来的 img 标签内容为以上替换后新的 img 标签内容\r\n              vnodeInnerHTMLObj.innerHTML = vnodeInnerHTMLObj.innerHTML.replace(img, newImg);\r\n            });\r\n            // 如果有传 v-model/modelValue\r\n            if (modelValue) {\r\n              if (isVue3 && typeof modelValue === 'string') {\r\n                // 如果是 Vue3 环境、双向梆定的变量是字符串，直接一次性调用 emits 反向修改梆定变量即可\r\n                emits('update:modelValue', vnodeInnerHTMLObj.innerHTML);\r\n              } else if (Array.isArray(modelValue)) {\r\n                // 必须有传递 props.htmlFieldName 才保存 modelValue 到新的对象数组 modelHtmlArr 中，\r\n                // 以便将 modelHtmlArr 作为以下 emits 调用函数的参数，重新触发 LazyLoadImgs 组件重新\r\n                // 渲染 v-html 指令梆定的 html 内容。\r\n                if (this._htmlFieldName) {\r\n                  // 如果双向梆定的变量是字符串数组，需要每次合并到数组中，最后（以下）再调用 emits 一次性反向修改梆定变量\r\n                  this._modelHtmlArr[this._modelHtmlIdx] = {\r\n                    ...modelValue[this._modelHtmlIdx],\r\n                    [this._htmlFieldName]: vnodeInnerHTMLObj.innerHTML,\r\n                  };\r\n                  // console.log('modelHtmlIdx:', this._modelHtmlIdx);\r\n                  this._modelHtmlIdx++;\r\n                } else if (isVue3) {\r\n                  // 如果是 Vue3 环境，才提示需要传 props.htmlFieldName，\r\n                  // 因为 Vue2 不用传 v-model 和 props.htmlFieldName 也能实现懒加载 v-html 指令梆定的图片\r\n                  console.error(`${this._logMsgPrefix} The Props htmlFieldName cannot be empty! \r\nPlease specify, for example:\r\n<LazyLoadImgs htmlFieldName=\"content\">Some HTML tags</LazyLoadImgs>`);\r\n                  return;\r\n                }\r\n              }\r\n            }\r\n            // console.log('vnodeInnerHTMLObj.innerHTML:', vnodeInnerHTMLObj.innerHTML);\r\n            console.log('modelHtmlArr:', JSON.stringify(this._modelHtmlArr));\r\n          }\r\n        } else {\r\n          // 否则插槽节点有子节点\r\n          this.setImgSrcToLoadingImg(vnode.children as VNode[], modelValue, emits);\r\n        }\r\n      });\r\n      // 如果是 Vue3 环境、有传递双向梆定的变量、有传文章内容的 html 字段名，调用 emits 一次性反向修改梆定变量\r\n      if (isVue3 && this._modelHtmlArr.length && this._htmlFieldName) {\r\n        emits('update:modelValue', this._modelHtmlArr);\r\n      }\r\n    }\r\n\r\n    // 返回已递归处理的插槽内的 img 标签对应的 data-img-id 属性值\r\n    return this._dataImgIdList;\r\n  }\r\n\r\n  /**\r\n   * @description - 创建用于实现懒加载图片，监听图片是否已经进入设置的交叉比例可视区的 IntersectionObserver 类的实例对象\r\n   * @memberof Lazy\r\n   * @returns\r\n   */\r\n  public createImgObserver(): IntersectionObserver {\r\n    this._imgObserver = new IntersectionObserver(\r\n      (entries: IntersectionObserverEntry[], observer: IntersectionObserver) => {\r\n        // entries 是所有被监听的 HTML DOM 对象的数组列表，\r\n        // observer 是监听实例对象，同 this._imgObserver。\r\n\r\n        // 循环判断每个监听项，这个回调函数会在以下执行 this._imgObserver.observer(target) 方法后生效，\r\n        // 拖动滚动条时，就会触发执行这个回函进行判断图片是否已进入可视区\r\n        entries.forEach(async (entry) => {\r\n          if (entry.isIntersecting) {\r\n            if (this._lazyOptions.delay! > 0) {\r\n              await this._delayIntersectionCallback(entry);\r\n            } else {\r\n              this._intersectionCallback(entry);\r\n            }\r\n          }\r\n        });\r\n      },\r\n      this._observerOptions\r\n    );\r\n\r\n    // 返回 IntersectionObserver 实例对象给组件的 onMounted 钩子函数中，循环遍历监听需要懒加载的图片\r\n    return this._imgObserver;\r\n  }\r\n\r\n  /**\r\n   * @description - 对图片进入可视区的处理回调函数\r\n   * @param entry\r\n   * @memberof Lazy\r\n   * @returns\r\n   */\r\n  private _intersectionCallback(entry: IntersectionObserverEntry): void {\r\n    // 如果图片已进入可视区\r\n    if (entry.isIntersecting) {\r\n      // 图片进入可视区后，停止对图片的 observer，无论是否加载成功，都停止对图片的再次监听，防止消耗性能\r\n      this._imgObserver?.unobserve(entry.target);\r\n\r\n      // 修改图片未进入可视区前（mounted勾子函数中）设置的 src=loadingImg，更改为 src=src 原来真实的图片地址，实现懒加载效果\r\n      this._setImgSrc(entry.target as HTMLImageElement);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * @description - 对图片进入可视区的延迟处理回调函数\r\n   * @param entry\r\n   * @memberof Lazy\r\n   * @returns {Promise<void>}\r\n   */\r\n  private _delayIntersectionCallback(entry: IntersectionObserverEntry): Promise<void> {\r\n    return new Promise((resolve, reject) => {\r\n      if (entry.isIntersecting) {\r\n        // 如果进入可视区，设置加载延迟器\r\n        // 如果延迟加载正在生效，则直接返回\r\n        if (entry.target.hasAttribute(EImgCustAttr.TIMEOUT_ID)) return;\r\n\r\n        // 否则开启加载延迟器\r\n        let timeoutId = setTimeout(() => {\r\n          this._intersectionCallback(entry);\r\n          // 执行完延迟加载后，清除元素的延迟标签属性\r\n          entry.target.removeAttribute(EImgCustAttr.TIMEOUT_ID);\r\n        }, this._lazyOptions.delay);\r\n        entry.target.setAttribute(EImgCustAttr.TIMEOUT_ID, String(timeoutId));\r\n      } else {\r\n        // 否则没有进入可视区\r\n        // 针对刚进入可视区时，加载延迟器还没有到时间执行，又离开了可视区的情况，须清除加载延迟器\r\n        this.clearLazyTimeout(entry.target);\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   *\r\n   * @param imgEl\r\n   * @memberof Lazy\r\n   * @returns\r\n   */\r\n  private _setImgSrc(imgEl: HTMLImageElement): void {\r\n    if (imgEl.hasAttribute(EImgCustAttr.ORIG_SRC)) {\r\n      // 首次执行该 _setImgSrc 方法时，prevSrc（上一个设置的src）是组件在 beforeMount 钩子里设置的 loadingImg\r\n      let prevSrc = imgEl.getAttribute('src');\r\n      // 获取图片原来真实的 src\r\n      let origSrc = imgEl.getAttribute(EImgCustAttr.ORIG_SRC);\r\n      if (prevSrc !== origSrc) {\r\n        // 如果有传图片加载中状态的回调函数，则执行它\r\n        this._lifecycle(ELifecycle.LOADING, imgEl);\r\n        imgEl.setAttribute('src', origSrc!);\r\n      }\r\n      // 监听图片的加载状态，传入 img.onload 和 image.onerror 的回调函数\r\n      this._listenImgStatus(\r\n        imgEl,\r\n        () => {\r\n          // 图片加载成功的回调函数\r\n          // 如果不是在以下加载失败的回调中设置图片的 src 为 errorImg，\r\n          // 才执行用户传入的或默认的加载完成的函数\r\n          if (imgEl.getAttribute('src') !== this._lazyOptions.errorImg) {\r\n            this._lifecycle(ELifecycle.LOADED, imgEl);\r\n          }\r\n        },\r\n        () => {\r\n          // 图片加载失败的回调函数\r\n          // 停止 observer 对该图片的所有监听\r\n          this._imgObserver?.unobserve(imgEl);\r\n          // 执行用户传入的或默认的加载失败的函数\r\n          this._lifecycle(ELifecycle.ERROR, imgEl);\r\n\r\n          // 如果有传加载失败的图片url（其实没传也配置了默认值）\r\n          if (this._lazyOptions.errorImg) {\r\n            const currentImgSrc = imgEl.getAttribute('src');\r\n            // 如果当前图片的 src 不是错误图片的 url，则设置显示加载失败的错误图片\r\n            if (currentImgSrc !== this._lazyOptions.errorImg) {\r\n              imgEl.setAttribute('src', this._lazyOptions.errorImg);\r\n            }\r\n          }\r\n\r\n          // 控制台打印加载失败信息\r\n          console.error(\r\n            `${this._logMsgPrefix} 图片加载失败，图片 url 地址是：${imgEl.getAttribute(\r\n              EImgCustAttr.ORIG_SRC\r\n            )}`\r\n          );\r\n        }\r\n      );\r\n    }\r\n  }\r\n\r\n  /**\r\n   * @description - 监听图片加载成功/失败状态的回调函数\r\n   * @param imgEl\r\n   * @param successCallback\r\n   * @param errorCallback\r\n   * @memberof Lazy\r\n   * @returns\r\n   */\r\n  private _listenImgStatus(\r\n    imgEl: HTMLImageElement,\r\n    successCallback: ((this: GlobalEventHandlers, ev: Event) => any) | null,\r\n    errorCallback: OnErrorEventHandler\r\n  ): void {\r\n    imgEl.onload = successCallback;\r\n    imgEl.onerror = errorCallback;\r\n  }\r\n\r\n  /**\r\n   * @description - 清除加载延迟器\r\n   * @param imgEl - 懒加载图片元素对象\r\n   */\r\n  public clearLazyTimeout(imgEl: HTMLImageElement | Element): void {\r\n    // 针对以下情况，须清除加载延迟器：\r\n    // 1、刚进入可视区时，加载延迟器还没有到时间执行，又离开了可视区的情况；\r\n    // 2、组件被 onBeforeMount 时\r\n    if (imgEl.hasAttribute(EImgCustAttr.TIMEOUT_ID)) {\r\n      // 离开可视区后，清除还在生效的加载延迟器和元素的延迟标签属性\r\n      clearTimeout(Number(imgEl.getAttribute(EImgCustAttr.TIMEOUT_ID)));\r\n      imgEl.removeAttribute(EImgCustAttr.TIMEOUT_ID);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * @description - 判断如果存在图片加载状态的回调函数，则执行它\r\n   * @param lifecycle\r\n   * @param imgEl\r\n   * @memberof Lazy\r\n   * @returns\r\n   */\r\n  private _lifecycle(lifecycle: ELifecycle, imgEl: HTMLImageElement): void {\r\n    const { lifeFunc } = this._lazyOptions;\r\n    switch (lifecycle) {\r\n      // 判断是否执行图片加载中状态的回调函数\r\n      case ELifecycle.LOADING:\r\n        imgEl.setAttribute(EImgCustAttr.LOAD_STATUS, ELifecycle.LOADING);\r\n        // 如果加载中状态的回调函数存在，则执行它\r\n        if (lifeFunc && typeof lifeFunc[ELifecycle.LOADING] === 'function') {\r\n          lifeFunc[ELifecycle.LOADING]?.(imgEl);\r\n        }\r\n        break;\r\n      // 判断是否执行图片加载完成状态的回调函数\r\n      case ELifecycle.LOADED:\r\n        imgEl.setAttribute(EImgCustAttr.LOAD_STATUS, ELifecycle.LOADED);\r\n        if (lifeFunc && typeof lifeFunc[ELifecycle.LOADED] === 'function') {\r\n          lifeFunc[ELifecycle.LOADED]?.(imgEl);\r\n        }\r\n        break;\r\n      // 判断是否执行图片加载失败状态的回调函数\r\n      case ELifecycle.ERROR:\r\n        imgEl.setAttribute(EImgCustAttr.LOAD_STATUS, ELifecycle.ERROR);\r\n        if (lifeFunc && typeof lifeFunc[ELifecycle.ERROR] === 'function') {\r\n          lifeFunc[ELifecycle.ERROR]?.(imgEl);\r\n        }\r\n        break;\r\n      default:\r\n        break;\r\n    }\r\n  }\r\n}\r\n","<template>\r\n  <div class=\"lazyload-all-box\">\r\n    <!-- 默认插槽：包裹需要懒加载的图片或图片所在的容器 -->\r\n    <slot name=\"default\"></slot>\r\n  </div>\r\n</template>\r\n\r\n<script lang=\"ts\">\r\n// 从兼容 Vue2/Vue3 构建包的 vue-demi 库中导入组合式 Api\r\nimport {\r\n  defineComponent,\r\n  onBeforeMount,\r\n  onBeforeUnmount,\r\n  onBeforeUpdate,\r\n  onMounted,\r\n  onUnmounted,\r\n  onUpdated,\r\n  isVue2,\r\n  isVue3,\r\n  type PropType,\r\n  type VNode,\r\n  getCurrentInstance,\r\n  useSlots,\r\n  version as vueVersion,\r\n} from 'vue-demi';\r\n\r\n// 导入懒加载配置项参数 lazyOptions 和 observer 配置项参数\r\nimport { lazyOptionsObj, observerOptionsObj } from '@/scripts/lazy-observer-options';\r\n\r\n// 导入 TS 类型声明\r\nimport { EImgCustAttr, EmitFunc, ILazyOptions } from '@/scripts/types';\r\n\r\n// 【重点】导入实现图片懒加载的实现类\r\nimport { Lazy } from '@/scripts/lazy.class';\r\n\r\n// 导入自定义的工具函数\r\nimport { deepCopy, waitLoadingImg } from '@/scripts/utils';\r\n\r\nexport default defineComponent({\r\n  // 定义组件名字\r\n  name: 'LazyLoadImgs',\r\n  // 声明接收 props\r\n  props: {\r\n    // 用于接收支持 v-html 指令渲染 html 字符串数组的双向梆定参数\r\n    [isVue2 ? 'value' : 'modelValue']: {\r\n      type: [String, Array] as PropType<string | object[]>,\r\n      required: false,\r\n    },\r\n    // 懒加载选项参数配置\r\n    lazyOptions: {\r\n      type: Object as PropType<ILazyOptions>,\r\n      required: false,\r\n      default: () => deepCopy(lazyOptionsObj),\r\n    },\r\n    // observer 选项参数配置\r\n    observerOptions: {\r\n      type: Object as PropType<IntersectionObserverInit>,\r\n      required: false,\r\n      default: () => deepCopy(observerOptionsObj),\r\n    },\r\n    // 由 Props 传入的自定义比如从后端获取的文章信息列表中每篇文章的 html 内容字段名，\r\n    // 使用 v-html 指令渲染 html 格式的文章内容时，必须传该参数\r\n    htmlFieldName: {\r\n      type: String as PropType<string>,\r\n      required: false,\r\n    },\r\n  },\r\n\r\n  // 定义接收自定义事件或 v-model 双向梆定事件参数（Vue2 无须定义 emits）\r\n  emits: isVue2 ? [] : ['update:modelValue'],\r\n\r\n  // setup 勾子函数\r\n  // 经测试 Vue2 中在 onBeforeMount 钩子中直接使用 setup(props,{slots}) 解构的 slot.default 为空，\r\n  // 需使用 const app = getCurrentInstance(); const defaultSlotVnodes = app.slots.default;\r\n  setup(props, { emit, attrs /* , slots */ }) {\r\n    if (isVue2) {\r\n      console.log('这里是 Vue2 环境...');\r\n    } else if (isVue3) {\r\n      console.log('这里是 Vue3 环境...');\r\n    }\r\n\r\n    // console.log('props:', props);\r\n\r\n    // 把用户传过来的 Props 对象参数 lazyOptions 或 observerOptions 与默认的对象参数进行合并\r\n    const lazyOptions: ILazyOptions = Object.assign({}, lazyOptionsObj, props.lazyOptions);\r\n    const observerOptions: IntersectionObserverInit = Object.assign(\r\n      {},\r\n      observerOptionsObj,\r\n      props.observerOptions\r\n    );\r\n\r\n    // 保存 <img> 标签里 data-img-id 属性值的数组\r\n    let dataImgIdList: string[] = [];\r\n\r\n    // 【重点】创建图片懒加载实现类 Lazy 的实例对象\r\n    // @ts-ignore 以上定义了动态 props.modelValue，所以这里 props.htmlFieldName 会报类型错误，可能是 vscode 或 ts 版本问题导致，忽略该类型报错即可，不影响运行\r\n    const lazy = new Lazy(lazyOptions, observerOptions, props.htmlFieldName);\r\n\r\n    // 当前组件实例ID（Lazy 类静态属性ID）\r\n    let instId = Lazy.instId;\r\n\r\n    // 获取 Vue app 实例引用\r\n    const app = getCurrentInstance();\r\n\r\n    // 创建用于实现懒加载图片监听器的 IntersectionObserver 类的实例对象\r\n    let imgObserver: IntersectionObserver;\r\n\r\n    // 根据不同的 Vue 版本，使用不同的方式获取默认插槽的 VNodes 的函数\r\n    const getDefaultSlotVnodes = () => {\r\n      let defaultSlotVnodes: VNode[] = [];\r\n\r\n      // 【重点】Vue2/3 兼容写法：获取插槽内容；经测试 Vue2 中在 onBeforeMount 钩子中直接使用 setup(props,{slots})\r\n      // 解构的 slot.default 为空。Vue2 只能在选项式 methods 节点在 beforeMount 钩子里使用 this.$slots.default 获取，\r\n      // 或如下使用 const app = getCurrentInstance(); const slots = app?.slots; 获取\r\n      // let slots = app?.slots;  // 经测试，此方式只兼容 Vue3/Vue2.6，Vue2.7 此方式无法获取 slots，\r\n      // Vue2.7 需使用 let slots = useSlots(); Vue3 可以使用 app.slots 也可以使用 useSlots()\r\n      if (vueVersion.startsWith('2.6')) {\r\n        // @ts-ignore\r\n        let slots = app?.slots;\r\n        defaultSlotVnodes = slots?.default as any;\r\n      } else {\r\n        let slots = useSlots();\r\n        defaultSlotVnodes = slots!.default?.()!;\r\n      }\r\n\r\n      return defaultSlotVnodes;\r\n    };\r\n\r\n    /******************** 生命周期钩子函数 - start ********************/\r\n    /**\r\n     * 本组件实例挂载前的钩子函数\r\n     * 用于获取父组件（要使用本懒加载组件的上级组件）传过来的，要用于进行懒加载的容器里（如div）的所有图片，\r\n     * 或直接传一个图片标签<img>进行懒加载的插槽内容\r\n     */\r\n    onBeforeMount(() => {\r\n      // 获取本组件的默认插槽的 vnodes\r\n      const defaultSlotVnodes: VNode[] = getDefaultSlotVnodes();\r\n      console.log('default slot vnodes:', defaultSlotVnodes);\r\n\r\n      // 调用懒加载实现类对象的 setImgSrcToLoadingImg 方法递归处理默认插槽内的 img 标签虚拟节点，\r\n      // 替换原来的 src 属性为 loadingImg，并将原图src设置到 data-orig-src 属性中\r\n      const modelData = isVue2 ? props.value : props.modelValue;\r\n      // @ts-ignore 以上定义了动态 props.modelValue，所以这里 modelData 会报类型错误，可能是 vscode 或 ts 版本问题导致，忽略该类型报错即可，不影响运行\r\n      dataImgIdList = lazy.setImgSrcToLoadingImg(defaultSlotVnodes, modelData, emit as EmitFunc);\r\n      // console.log('dataImgIdList:', dataImgIdList, instId);\r\n    });\r\n\r\n    /**\r\n     * 本组件实例挂载后的钩子函数\r\n     */\r\n    onMounted(async () => {\r\n      // 创建 observer\r\n      imgObserver = lazy.createImgObserver();\r\n\r\n      // 获取本组件每个实例需要开启监听的每个 img 元素（即使用本组件标签包裹起来的所有 img 标签集合）\r\n      const allImgs = document.querySelectorAll(`img[${EImgCustAttr.IMG_ID}^=inst${instId}-]`);\r\n      // console.log('allImgs:', allImgs, instId);\r\n\r\n      // 1、由于使用 IntersectionObserver 实现懒加载图片时，调用其实例的 observe() 方法监听图片前，需要先设置图片对象的\r\n      // width 和 height 属性或其 css 样式，否则默认宽高为0，会加载所有图片；\r\n      // 所以，这里先使用自定义工具函数 createImgObjFromUrl 先创建并加载默认（或传过来的 props）的预加载图片 loadingImg 对象，\r\n      // 等待创建完成，并显示预加载图片占用显示空间后，再使用 IntersectionObserver 实例的 observer() 方法监听图片，\r\n      // 这样，不用预先设置图片的宽高样式，也能实现懒加载效果，但显示的懒加载图片大小与实际图片大小不一致。\r\n      // 【因此强烈建议】：使用本组件前，为所有需要实现懒加载的图片设置 css 宽高样式）。\r\n      const { img, err } = await waitLoadingImg(lazyOptions.loadingImg!, instId).catch((err) => err);\r\n      // console.log('loadingImgObj, err, instId:', img, err, instId);\r\n\r\n      // 2、然后，再循环开启监听每个 img 元素\r\n      Array.prototype.forEach.call(allImgs, (imgEl: HTMLImageElement) => imgObserver.observe(imgEl));\r\n    });\r\n\r\n    /**\r\n     * 本组件实例更新前的钩子函数\r\n     */\r\n    onBeforeUpdate(() => {\r\n      // console.log('LazyLoadImgs onBeforeUpdate');\r\n    });\r\n\r\n    /**\r\n     * 本组件实例更新后的钩子函数\r\n     */\r\n    onUpdated(() => {\r\n      // console.log('LazyLoadImgs onUpdated');\r\n    });\r\n\r\n    /**\r\n     * 本组件实例卸载前的钩子函数\r\n     */\r\n    onBeforeUnmount(() => {\r\n      // 在卸载组件前，停止已经开启图片加载的延迟器\r\n      const delayImgs = document.querySelectorAll(\r\n        `img[${EImgCustAttr.IMG_ID}^=inst${instId}-][${EImgCustAttr.TIMEOUT_ID}]`\r\n      );\r\n      Array.prototype.forEach.call(delayImgs, (imgEl: HTMLImageElement) => lazy.clearLazyTimeout(imgEl));\r\n    });\r\n\r\n    /**\r\n     * 本组件实例卸载后的钩子函数\r\n     */\r\n    onUnmounted(() => {\r\n      // 组件卸载后，对应的实例ID数减一\r\n      Lazy.instId--;\r\n\r\n      // 停止监听所有图片进入交叉可视区状态\r\n      imgObserver.disconnect();\r\n    });\r\n    /******************** 生命周期钩子函数 - end ********************/\r\n\r\n    // 暴露内部变量在组件实例身上（可供外部读取）\r\n    return {\r\n      // 暴露本组件实例对应的实例ID（实则 Lazy 类的递增实例ID）\r\n      instId,\r\n    };\r\n  },\r\n});\r\n</script>\r\n\r\n<style lang=\"scss\" scoped></style>\r\n","<template>\r\n  <div class=\"lazyload-all-box\">\r\n    <!-- 默认插槽：包裹需要懒加载的图片或图片所在的容器 -->\r\n    <slot name=\"default\"></slot>\r\n  </div>\r\n</template>\r\n\r\n<script lang=\"ts\">\r\n// 从兼容 Vue2/Vue3 构建包的 vue-demi 库中导入组合式 Api\r\nimport {\r\n  defineComponent,\r\n  onBeforeMount,\r\n  onBeforeUnmount,\r\n  onBeforeUpdate,\r\n  onMounted,\r\n  onUnmounted,\r\n  onUpdated,\r\n  isVue2,\r\n  isVue3,\r\n  type PropType,\r\n  type VNode,\r\n  getCurrentInstance,\r\n  useSlots,\r\n  version as vueVersion,\r\n} from 'vue-demi';\r\n\r\n// 导入懒加载配置项参数 lazyOptions 和 observer 配置项参数\r\nimport { lazyOptionsObj, observerOptionsObj } from '@/scripts/lazy-observer-options';\r\n\r\n// 导入 TS 类型声明\r\nimport { EImgCustAttr, EmitFunc, ILazyOptions } from '@/scripts/types';\r\n\r\n// 【重点】导入实现图片懒加载的实现类\r\nimport { Lazy } from '@/scripts/lazy.class';\r\n\r\n// 导入自定义的工具函数\r\nimport { deepCopy, waitLoadingImg } from '@/scripts/utils';\r\n\r\nexport default defineComponent({\r\n  // 定义组件名字\r\n  name: 'LazyLoadImgs',\r\n  // 声明接收 props\r\n  props: {\r\n    // 用于接收支持 v-html 指令渲染 html 字符串数组的双向梆定参数\r\n    [isVue2 ? 'value' : 'modelValue']: {\r\n      type: [String, Array] as PropType<string | object[]>,\r\n      required: false,\r\n    },\r\n    // 懒加载选项参数配置\r\n    lazyOptions: {\r\n      type: Object as PropType<ILazyOptions>,\r\n      required: false,\r\n      default: () => deepCopy(lazyOptionsObj),\r\n    },\r\n    // observer 选项参数配置\r\n    observerOptions: {\r\n      type: Object as PropType<IntersectionObserverInit>,\r\n      required: false,\r\n      default: () => deepCopy(observerOptionsObj),\r\n    },\r\n    // 由 Props 传入的自定义比如从后端获取的文章信息列表中每篇文章的 html 内容字段名，\r\n    // 使用 v-html 指令渲染 html 格式的文章内容时，必须传该参数\r\n    htmlFieldName: {\r\n      type: String as PropType<string>,\r\n      required: false,\r\n    },\r\n  },\r\n\r\n  // 定义接收自定义事件或 v-model 双向梆定事件参数（Vue2 无须定义 emits）\r\n  emits: isVue2 ? [] : ['update:modelValue'],\r\n\r\n  // setup 勾子函数\r\n  // 经测试 Vue2 中在 onBeforeMount 钩子中直接使用 setup(props,{slots}) 解构的 slot.default 为空，\r\n  // 需使用 const app = getCurrentInstance(); const defaultSlotVnodes = app.slots.default;\r\n  setup(props, { emit, attrs /* , slots */ }) {\r\n    if (isVue2) {\r\n      console.log('这里是 Vue2 环境...');\r\n    } else if (isVue3) {\r\n      console.log('这里是 Vue3 环境...');\r\n    }\r\n\r\n    // console.log('props:', props);\r\n\r\n    // 把用户传过来的 Props 对象参数 lazyOptions 或 observerOptions 与默认的对象参数进行合并\r\n    const lazyOptions: ILazyOptions = Object.assign({}, lazyOptionsObj, props.lazyOptions);\r\n    const observerOptions: IntersectionObserverInit = Object.assign(\r\n      {},\r\n      observerOptionsObj,\r\n      props.observerOptions\r\n    );\r\n\r\n    // 保存 <img> 标签里 data-img-id 属性值的数组\r\n    let dataImgIdList: string[] = [];\r\n\r\n    // 【重点】创建图片懒加载实现类 Lazy 的实例对象\r\n    // @ts-ignore 以上定义了动态 props.modelValue，所以这里 props.htmlFieldName 会报类型错误，可能是 vscode 或 ts 版本问题导致，忽略该类型报错即可，不影响运行\r\n    const lazy = new Lazy(lazyOptions, observerOptions, props.htmlFieldName);\r\n\r\n    // 当前组件实例ID（Lazy 类静态属性ID）\r\n    let instId = Lazy.instId;\r\n\r\n    // 获取 Vue app 实例引用\r\n    const app = getCurrentInstance();\r\n\r\n    // 创建用于实现懒加载图片监听器的 IntersectionObserver 类的实例对象\r\n    let imgObserver: IntersectionObserver;\r\n\r\n    // 根据不同的 Vue 版本，使用不同的方式获取默认插槽的 VNodes 的函数\r\n    const getDefaultSlotVnodes = () => {\r\n      let defaultSlotVnodes: VNode[] = [];\r\n\r\n      // 【重点】Vue2/3 兼容写法：获取插槽内容；经测试 Vue2 中在 onBeforeMount 钩子中直接使用 setup(props,{slots})\r\n      // 解构的 slot.default 为空。Vue2 只能在选项式 methods 节点在 beforeMount 钩子里使用 this.$slots.default 获取，\r\n      // 或如下使用 const app = getCurrentInstance(); const slots = app?.slots; 获取\r\n      // let slots = app?.slots;  // 经测试，此方式只兼容 Vue3/Vue2.6，Vue2.7 此方式无法获取 slots，\r\n      // Vue2.7 需使用 let slots = useSlots(); Vue3 可以使用 app.slots 也可以使用 useSlots()\r\n      if (vueVersion.startsWith('2.6')) {\r\n        // @ts-ignore\r\n        let slots = app?.slots;\r\n        defaultSlotVnodes = slots?.default as any;\r\n      } else {\r\n        let slots = useSlots();\r\n        defaultSlotVnodes = slots!.default?.()!;\r\n      }\r\n\r\n      return defaultSlotVnodes;\r\n    };\r\n\r\n    /******************** 生命周期钩子函数 - start ********************/\r\n    /**\r\n     * 本组件实例挂载前的钩子函数\r\n     * 用于获取父组件（要使用本懒加载组件的上级组件）传过来的，要用于进行懒加载的容器里（如div）的所有图片，\r\n     * 或直接传一个图片标签<img>进行懒加载的插槽内容\r\n     */\r\n    onBeforeMount(() => {\r\n      // 获取本组件的默认插槽的 vnodes\r\n      const defaultSlotVnodes: VNode[] = getDefaultSlotVnodes();\r\n      console.log('default slot vnodes:', defaultSlotVnodes);\r\n\r\n      // 调用懒加载实现类对象的 setImgSrcToLoadingImg 方法递归处理默认插槽内的 img 标签虚拟节点，\r\n      // 替换原来的 src 属性为 loadingImg，并将原图src设置到 data-orig-src 属性中\r\n      const modelData = isVue2 ? props.value : props.modelValue;\r\n      // @ts-ignore 以上定义了动态 props.modelValue，所以这里 modelData 会报类型错误，可能是 vscode 或 ts 版本问题导致，忽略该类型报错即可，不影响运行\r\n      dataImgIdList = lazy.setImgSrcToLoadingImg(defaultSlotVnodes, modelData, emit as EmitFunc);\r\n      // console.log('dataImgIdList:', dataImgIdList, instId);\r\n    });\r\n\r\n    /**\r\n     * 本组件实例挂载后的钩子函数\r\n     */\r\n    onMounted(async () => {\r\n      // 创建 observer\r\n      imgObserver = lazy.createImgObserver();\r\n\r\n      // 获取本组件每个实例需要开启监听的每个 img 元素（即使用本组件标签包裹起来的所有 img 标签集合）\r\n      const allImgs = document.querySelectorAll(`img[${EImgCustAttr.IMG_ID}^=inst${instId}-]`);\r\n      // console.log('allImgs:', allImgs, instId);\r\n\r\n      // 1、由于使用 IntersectionObserver 实现懒加载图片时，调用其实例的 observe() 方法监听图片前，需要先设置图片对象的\r\n      // width 和 height 属性或其 css 样式，否则默认宽高为0，会加载所有图片；\r\n      // 所以，这里先使用自定义工具函数 createImgObjFromUrl 先创建并加载默认（或传过来的 props）的预加载图片 loadingImg 对象，\r\n      // 等待创建完成，并显示预加载图片占用显示空间后，再使用 IntersectionObserver 实例的 observer() 方法监听图片，\r\n      // 这样，不用预先设置图片的宽高样式，也能实现懒加载效果，但显示的懒加载图片大小与实际图片大小不一致。\r\n      // 【因此强烈建议】：使用本组件前，为所有需要实现懒加载的图片设置 css 宽高样式）。\r\n      const { img, err } = await waitLoadingImg(lazyOptions.loadingImg!, instId).catch((err) => err);\r\n      // console.log('loadingImgObj, err, instId:', img, err, instId);\r\n\r\n      // 2、然后，再循环开启监听每个 img 元素\r\n      Array.prototype.forEach.call(allImgs, (imgEl: HTMLImageElement) => imgObserver.observe(imgEl));\r\n    });\r\n\r\n    /**\r\n     * 本组件实例更新前的钩子函数\r\n     */\r\n    onBeforeUpdate(() => {\r\n      // console.log('LazyLoadImgs onBeforeUpdate');\r\n    });\r\n\r\n    /**\r\n     * 本组件实例更新后的钩子函数\r\n     */\r\n    onUpdated(() => {\r\n      // console.log('LazyLoadImgs onUpdated');\r\n    });\r\n\r\n    /**\r\n     * 本组件实例卸载前的钩子函数\r\n     */\r\n    onBeforeUnmount(() => {\r\n      // 在卸载组件前，停止已经开启图片加载的延迟器\r\n      const delayImgs = document.querySelectorAll(\r\n        `img[${EImgCustAttr.IMG_ID}^=inst${instId}-][${EImgCustAttr.TIMEOUT_ID}]`\r\n      );\r\n      Array.prototype.forEach.call(delayImgs, (imgEl: HTMLImageElement) => lazy.clearLazyTimeout(imgEl));\r\n    });\r\n\r\n    /**\r\n     * 本组件实例卸载后的钩子函数\r\n     */\r\n    onUnmounted(() => {\r\n      // 组件卸载后，对应的实例ID数减一\r\n      Lazy.instId--;\r\n\r\n      // 停止监听所有图片进入交叉可视区状态\r\n      imgObserver.disconnect();\r\n    });\r\n    /******************** 生命周期钩子函数 - end ********************/\r\n\r\n    // 暴露内部变量在组件实例身上（可供外部读取）\r\n    return {\r\n      // 暴露本组件实例对应的实例ID（实则 Lazy 类的递增实例ID）\r\n      instId,\r\n    };\r\n  },\r\n});\r\n</script>\r\n\r\n<style lang=\"scss\" scoped></style>\r\n","import { type App } from 'vue-demi';\r\nimport LazyLoadImgs from '@/components/lazy-load-imgs.vue';\r\nimport { ILazyOptions } from '@/scripts/types';\r\nimport { lazyOptionsObj } from '@/scripts/lazy-observer-options';\r\n\r\n// 定义要批量全局注册的组件数组\r\nconst comps = [LazyLoadImgs];\r\n\r\n// 导出全局注册的 LazyLoadImgs 组件\r\nconst install = (app: App, options: ILazyOptions = {}): any => {\r\n  // 将用户全局注册本组件时传入的作为组件的 Props 参数选项，覆盖到默认参数中\r\n  Object.assign(lazyOptionsObj, options);\r\n\r\n  // 注册本组件\r\n  comps.forEach((comp: any, i: number) => {\r\n    app.component(comp.name, comp);\r\n    console.log('comp.name:', comp.name, comp);\r\n  });\r\n};\r\nexport default install;\r\n\r\nexport { LazyLoadImgs };\r\n"],"names":["DEFAULT_LOADING_IMG","lazyOptionsObj","observerOptionsObj","ELifecycle","EImgCustAttr","isObject","value","isArray","isFunc","isDate","isRegExp","isError","deepCopy","obj","which","newObj","k","i","arr","v","errorProps","newError","newSetItems","map2Obj","newMap2Obj","waitLoadingImg","imgUrl","instId","resolve","reject","img","e","allImgs","_Lazy","lazyOptions","observerOptions","htmlFieldName","__publicField","vnodes","modelValue","emits","dataImgId","imgHtmlReg","imgsInHtml","vnode","vnodeProps","isVue2","vnodeInnerHTMLObj","dataIdAttr","srcVal","origSrcAttr","newImg","isVue3","entries","observer","entry","timeoutId","imgEl","prevSrc","origSrc","successCallback","errorCallback","lifecycle","lifeFunc","Lazy","_sfc_main","defineComponent","props","emit","attrs","lazy","app","getCurrentInstance","imgObserver","getDefaultSlotVnodes","defaultSlotVnodes","vueVersion","useSlots","onBeforeMount","modelData","onMounted","err","onBeforeUpdate","onUpdated","onBeforeUnmount","delayImgs","onUnmounted","_sfc_render","_ctx","_cache","$props","$setup","$data","$options","comps","LazyLoadImgs","install","options","comp"],"mappings":"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"}